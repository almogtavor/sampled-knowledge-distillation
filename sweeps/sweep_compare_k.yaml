# sweep_compare_k.yaml
name: compare_k
method: grid
parameters:
  distill_type:
    values: ["top-k-tok"]   # set to ["vanilla"] if you want the vanilla-only sweep
  k_percent:
    values: [0, 1, 2, 5, 10, 12, 15, 20, 25, 30, 40, 50, 75, 100]
  eval_suite:
    values: ["light"]       # matches kd_sweep.sh default
  epochs:
    values: [1]             # set to [1] for a quick pass
  anneal_flag:
    values: [""]            # no annealing
command:
  - bash
  - -lc
  - >
    JOB_ID=$(sbatch --parsable --export=ALL
    train.slurm
    ${distill_type}
    ${k_percent}
    ${epochs});
    echo "Submitted SLURM job ${JOB_ID}";
    # Wait until the job leaves the queue (RUNNING/COMPLETED/FAILED/etc.)
    while squeue -h -j "${JOB_ID}" >/dev/null 2>&1; do sleep 20; done;
    echo "SLURM job ${JOB_ID} finished."
